"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function _construct(){return _construct=isNativeReflectConstruct()?Reflect.construct:function(b,c,d){var e=[null];e.push.apply(e,c);var a=Function.bind.apply(b,e),f=new a;return d&&_setPrototypeOf(f,d.prototype),f},_construct.apply(null,arguments)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}var timerSimulator,degree=function(a){return a*Math.PI/180},cubeCorner={vertices:[[6.343219,-23.213209,-7.941401],[29e-6,-29e-6,-7.941401],[23.213898,-6.218769,-7.941401],[23.216801,-23.216118,-7.941401],[23.213898,-6.218769,-7.941401],[29e-6,-29e-6,-7.941401],[29e-6,-29e-6,7.998172],[23.213898,-6.218769,7.998172],[23.213898,-6.218769,-7.941401],[29e-6,-29e-6,-7.941401],[29e-6,-29e-6,-7.941401],[23.213898,-6.218769,-7.941401],[6.343219,-23.213209,-7.941401],[23.216801,-23.216118,-7.941401],[23.216801,-23.216118,-7.941401],[6.343219,-23.213209,-7.941401],[23.213898,-6.218769,7.998172],[29e-6,-29e-6,7.998172],[1.319375,-1.316229,7.998172],[22.211857,-6.913095,7.998172],[6.343219,-23.213209,7.998172],[6.343219,-23.213209,-7.941401],[7.186899,-23.213354,-7.144422],[7.186899,-23.213354,7.201192],[23.216801,-23.216118,-7.941401],[23.213898,-6.218769,-7.941401],[23.214043,-7.068637,-7.144422],[23.216656,-22.366249,-7.144422],[29e-6,-29e-6,-7.941401],[6.343219,-23.213209,-7.941401],[6.343219,-23.213209,7.998172],[29e-6,-29e-6,7.998172],[7.028246,-22.208092,7.998172],[22.21447,-22.210709,7.998172],[21.31237,-21.30584,8.998173],[7.644771,-21.303486,8.998173],[6.343219,-23.213209,7.998172],[23.216801,-23.216118,7.998172],[22.21447,-22.210709,7.998172],[7.028246,-22.208092,7.998172],[7.644771,-21.303486,8.998173],[21.31237,-21.30584,8.998173],[21.31002,-7.537989,8.998173],[2.506786,-2.50081,8.998173],[22.21447,-22.210709,7.998172],[22.211857,-6.913095,7.998172],[21.31002,-7.537989,8.998173],[22.21447,-22.210709,7.998172],[21.31002,-7.537989,8.998173],[21.31237,-21.30584,8.998173],[1.319375,-1.316229,7.998172],[7.028246,-22.208092,7.998172],[7.644771,-21.303486,8.998173],[2.506786,-2.50081,8.998173],[22.211857,-6.913095,7.998172],[1.319375,-1.316229,7.998172],[2.506786,-2.50081,8.998173],[22.211857,-6.913095,7.998172],[2.506786,-2.50081,8.998173],[21.31002,-7.537989,8.998173],[23.216656,-22.366249,7.201192],[23.216656,-22.366249,-7.144422],[24.216526,-21.601368,-6.427141],[24.216526,-21.601368,6.483912],[23.213898,-6.218769,7.998172],[23.214043,-7.068637,7.201192],[23.216801,-23.216118,7.998172],[23.216656,-22.366249,7.201192],[24.216526,-21.601368,-6.427141],[24.214174,-7.833518,-6.427141],[24.214174,-7.833518,6.483912],[24.216526,-21.601368,6.483912],[23.214043,-7.068637,7.201192],[23.216656,-22.366249,7.201192],[24.216526,-21.601368,6.483912],[24.214174,-7.833518,6.483912],[23.214043,-7.068637,-7.144422],[23.214043,-7.068637,7.201192],[24.214174,-7.833518,6.483912],[24.214174,-7.833518,-6.427141],[23.216656,-22.366249,-7.144422],[23.214043,-7.068637,-7.144422],[24.214174,-7.833518,-6.427141],[24.216526,-21.601368,-6.427141],[22.373121,-23.215973,-7.144422],[22.373121,-23.215973,7.201192],[21.61381,-24.215841,6.483912],[21.61381,-24.215841,-6.427141],[23.216801,-23.216118,7.998172],[6.343219,-23.213209,7.998172],[7.186899,-23.213354,7.201192],[23.216801,-23.216118,7.998172],[7.186899,-23.213354,7.201192],[22.373121,-23.215973,7.201192],[23.216801,-23.216118,-7.941401],[23.216801,-23.216118,7.998172],[22.373121,-23.215973,7.201192],[22.373121,-23.215973,-7.144422],[6.343219,-23.213209,-7.941401],[23.216801,-23.216118,-7.941401],[22.373121,-23.215973,-7.144422],[6.343219,-23.213209,-7.941401],[22.373121,-23.215973,-7.144422],[7.186899,-23.213354,-7.144422],[7.94621,-24.213486,-6.427141],[21.61381,-24.215841,-6.427141],[21.61381,-24.215841,6.483912],[7.94621,-24.213486,6.483912],[7.186899,-23.213354,-7.144422],[22.373121,-23.215973,-7.144422],[21.61381,-24.215841,-6.427141],[7.186899,-23.213354,-7.144422],[21.61381,-24.215841,-6.427141],[7.94621,-24.213486,-6.427141],[7.186899,-23.213354,7.201192],[7.186899,-23.213354,-7.144422],[7.94621,-24.213486,-6.427141],[7.94621,-24.213486,6.483912],[22.373121,-23.215973,7.201192],[7.186899,-23.213354,7.201192],[7.94621,-24.213486,6.483912],[22.373121,-23.215973,7.201192],[7.94621,-24.213486,6.483912],[21.61381,-24.215841,6.483912]],faces:[[0,1,2],[0,2,3],[4,5,6],[4,6,7],[8,9,10],[8,10,11],[12,13,14],[12,14,15],[13,8,11],[13,11,14],[9,12,15],[9,15,10],[16,17,18],[16,18,19],[20,21,22],[20,22,23],[24,25,26],[24,26,27],[28,29,30],[28,30,31],[32,33,34],[32,34,35],[36,37,38],[36,38,39],[37,16,19],[37,19,38],[17,36,39],[17,39,18],[40,41,42],[40,42,43],[44,45,46],[47,48,49],[50,51,52],[50,52,53],[54,55,56],[57,58,59],[60,61,62],[60,62,63],[25,64,65],[25,65,26],[66,24,27],[66,27,67],[64,66,67],[64,67,65],[68,69,70],[68,70,71],[72,73,74],[72,74,75],[76,77,78],[76,78,79],[80,81,82],[80,82,83],[84,85,86],[84,86,87],[88,89,90],[91,92,93],[94,95,96],[94,96,97],[98,99,100],[101,102,103],[104,105,106],[104,106,107],[108,109,110],[111,112,113],[114,115,116],[114,116,117],[118,119,120],[121,122,123]]},cubeMiddle={vertices:[[-23.216793,23.216125,-7.994946],[-23.216118,-23.216799,-7.994946],[-23.216152,-22.239258,-7.19545],[-23.216793,23.216125,-7.994946],[-23.216152,-22.239258,-7.19545],[-23.216761,22.238586,-7.19545],[-23.216793,23.216125,7.994946],[6.287806,23.21389,7.994946],[5.199792,23.214001,7.19545],[-23.216793,23.216125,7.994946],[5.199792,23.214001,7.19545],[-22.408852,23.216015,7.19545],[6.287806,23.21389,-7.994946],[6.287806,23.21389,7.994946],[-6.494823,-23.213898,7.994946],[-6.494823,-23.213898,-7.994946],[-23.216118,-23.216799,7.994946],[-23.216118,-23.216799,-7.994946],[-22.380054,-23.216652,-7.19545],[-22.380054,-23.216652,7.19545],[-23.216793,23.216125,-7.994946],[6.287806,23.21389,-7.994946],[-6.494823,-23.213898,-7.994946],[-23.216118,-23.216799,-7.994946],[6.287806,23.21389,7.994946],[-23.216793,23.216125,7.994946],[-22.374868,21.920244,7.994946],[5.209332,21.918232,7.994946],[-7.014172,-22.200659,7.994946],[5.209332,21.918232,7.994946],[3.594032,20.831268,8.994946],[-7.014172,-22.200659,7.994946],[3.594032,20.831268,8.994946],[-7.676548,-20.834009,8.994946],[-6.494823,-23.213898,7.994946],[-7.014172,-22.200659,7.994946],[-23.216118,-23.216799,7.994946],[-22.371428,-22.203272,7.994946],[-23.216118,-23.216799,7.994946],[-22.371428,-22.203272,7.994946],[3.594032,20.831268,8.994946],[-21.334755,20.83308,8.994946],[-21.133863,-20.836294,8.994946],[-7.676548,-20.834009,8.994946],[-22.374868,21.920244,7.994946],[-22.371428,-22.203272,7.994946],[-21.133863,-20.836294,8.994946],[-22.374868,21.920244,7.994946],[-21.133863,-20.836294,8.994946],[-21.334755,20.83308,8.994946],[-22.371428,-22.203272,7.994946],[-7.014172,-22.200659,7.994946],[-7.676548,-20.834009,8.994946],[-22.371428,-22.203272,7.994946],[-7.676548,-20.834009,8.994946],[-21.133863,-20.836294,8.994946],[5.209332,21.918232,7.994946],[-22.374868,21.920244,7.994946],[-21.334755,20.83308,8.994946],[5.209332,21.918232,7.994946],[-21.334755,20.83308,8.994946],[3.594032,20.831268,8.994946],[-7.330889,-23.214043,-7.19545],[-7.330889,-23.214043,7.19545],[-8.083174,-24.214172,6.475904],[-8.083174,-24.214172,-6.475904],[-23.216118,-23.216799,-7.994946],[-6.494823,-23.213898,-7.994946],[-7.330889,-23.214043,-7.19545],[-23.216118,-23.216799,-7.994946],[-7.330889,-23.214043,-7.19545],[-22.380054,-23.216652,-7.19545],[-6.494823,-23.213898,7.994946],[-23.216118,-23.216799,7.994946],[-22.380054,-23.216652,7.19545],[-6.494823,-23.213898,7.994946],[-22.380054,-23.216652,7.19545],[-7.330889,-23.214043,7.19545],[-8.083174,-24.214172,-6.475904],[-8.083174,-24.214172,6.475904],[-21.627422,-24.21652,6.475904],[-21.627422,-24.21652,-6.475904],[-22.380054,-23.216652,-7.19545],[-7.330889,-23.214043,-7.19545],[-8.083174,-24.214172,-6.475904],[-21.627422,-24.21652,-6.475904],[-22.380054,-23.216652,7.19545],[-22.380054,-23.216652,-7.19545],[-21.627422,-24.21652,-6.475904],[-21.627422,-24.21652,6.475904],[-7.330889,-23.214043,7.19545],[-22.380054,-23.216652,7.19545],[-21.627422,-24.21652,6.475904],[-8.083174,-24.214172,6.475904],[-22.408852,23.216015,-7.19545],[-22.408852,23.216015,7.19545],[-21.610096,24.215912,6.475904],[-21.610096,24.215912,-6.475904],[-23.216793,23.216125,-7.994946],[-23.216793,23.216125,7.994946],[-22.408852,23.216015,7.19545],[-22.408852,23.216015,-7.19545],[6.287806,23.21389,7.994946],[6.287806,23.21389,-7.994946],[5.199792,23.214001,-7.19545],[5.199792,23.214001,7.19545],[6.287806,23.21389,-7.994946],[-23.216793,23.216125,-7.994946],[-22.408852,23.216015,-7.19545],[6.287806,23.21389,-7.994946],[-22.408852,23.216015,-7.19545],[5.199792,23.214001,-7.19545],[-21.610096,24.215912,-6.475904],[-21.610096,24.215912,6.475904],[4.401181,24.2141,6.475904],[4.401181,24.2141,-6.475904],[5.199792,23.214001,7.19545],[5.199792,23.214001,-7.19545],[4.401181,24.2141,-6.475904],[5.199792,23.214001,7.19545],[4.401181,24.2141,-6.475904],[4.401181,24.2141,6.475904],[5.199792,23.214001,-7.19545],[-22.408852,23.216015,-7.19545],[-21.610096,24.215912,-6.475904],[5.199792,23.214001,-7.19545],[-21.610096,24.215912,-6.475904],[4.401181,24.2141,-6.475904],[-22.408852,23.216015,7.19545],[5.199792,23.214001,7.19545],[4.401181,24.2141,6.475904],[-22.408852,23.216015,7.19545],[4.401181,24.2141,6.475904],[-21.610096,24.215912,6.475904],[-23.216152,-22.239258,7.19545],[-23.216761,22.238586,7.19545],[-24.216728,21.204359,6.572843],[-23.216152,-22.239258,7.19545],[-24.216728,21.204359,6.572843],[-24.216183,-21.205061,6.572843],[-23.216793,23.216125,7.994946],[-23.216793,23.216125,-7.994946],[-23.216761,22.238586,-7.19545],[-23.216761,22.238586,7.19545],[-23.216118,-23.216799,-7.994946],[-23.216118,-23.216799,7.994946],[-23.216152,-22.239258,7.19545],[-23.216152,-22.239258,-7.19545],[-23.216118,-23.216799,7.994946],[-23.216793,23.216125,7.994946],[-23.216761,22.238586,7.19545],[-23.216118,-23.216799,7.994946],[-23.216761,22.238586,7.19545],[-23.216152,-22.239258,7.19545],[-24.216183,-21.205061,-6.572843],[-24.216183,-21.205061,6.572843],[-24.216728,21.204359,6.572843],[-24.216728,21.204359,-6.572843],[-23.216761,22.238586,-7.19545],[-23.216152,-22.239258,-7.19545],[-24.216183,-21.205061,-6.572843],[-23.216761,22.238586,-7.19545],[-24.216183,-21.205061,-6.572843],[-24.216728,21.204359,-6.572843],[-23.216761,22.238586,7.19545],[-23.216761,22.238586,-7.19545],[-24.216728,21.204359,-6.572843],[-24.216728,21.204359,6.572843],[-23.216152,-22.239258,-7.19545],[-23.216152,-22.239258,7.19545],[-24.216183,-21.205061,6.572843],[-24.216183,-21.205061,-6.572843]],faces:[[0,1,2],[3,4,5],[6,7,8],[9,10,11],[12,13,14],[12,14,15],[16,17,18],[16,18,19],[20,21,22],[20,22,23],[24,25,26],[24,26,27],[28,29,30],[31,32,33],[34,24,27],[34,27,35],[25,36,37],[25,37,26],[38,34,35],[38,35,39],[40,41,42],[40,42,43],[44,45,46],[47,48,49],[50,51,52],[53,54,55],[56,57,58],[59,60,61],[62,63,64],[62,64,65],[66,67,68],[69,70,71],[72,73,74],[75,76,77],[67,75,77],[67,77,68],[78,79,80],[78,80,81],[82,83,84],[82,84,85],[86,87,88],[86,88,89],[90,91,92],[90,92,93],[94,95,96],[94,96,97],[98,99,100],[98,100,101],[102,103,104],[102,104,105],[106,107,108],[109,110,111],[112,113,114],[112,114,115],[116,117,118],[119,120,121],[122,123,124],[125,126,127],[128,129,130],[131,132,133],[134,135,136],[137,138,139],[140,141,142],[140,142,143],[144,145,146],[144,146,147],[148,149,150],[151,152,153],[154,155,156],[154,156,157],[158,159,160],[161,162,163],[164,165,166],[164,166,167],[168,169,170],[168,170,171]]},cubeEdge={vertices:[[-23.21389,6.218787,-7.945311],[-23.213209,-6.3432,-7.945311],[27e-6,-19e-6,-7.945311],[-23.21389,6.218787,7.99426],[27e-6,-19e-6,7.99426],[-3.556697,-.009949,7.99426],[-22.05957,4.719353,7.99426],[-23.21389,6.218787,-7.945311],[27e-6,-19e-6,-7.945311],[27e-6,-19e-6,7.99426],[-23.21389,6.218787,7.99426],[27e-6,-19e-6,-7.945311],[-23.213209,-6.3432,-7.945311],[-23.213209,-6.3432,7.99426],[27e-6,-19e-6,7.99426],[-23.213209,-6.3432,7.99426],[-23.213209,-6.3432,-7.945311],[-23.213243,-5.430953,-7.148333],[-23.213243,-5.430953,7.197281],[-22.05957,4.719353,7.99426],[-3.556697,-.009949,7.99426],[-6.288249,-.016716,8.994261],[-22.05957,4.719353,7.99426],[-6.288249,-.016716,8.994261],[-21.442791,3.697532,8.994261],[-23.213209,-6.3432,7.99426],[-22.05899,-4.833837,7.99426],[-21.442791,3.697532,8.994261],[-6.288249,-.016716,8.994261],[-21.442266,-3.805248,8.994261],[-3.556697,-.009949,7.99426],[-22.05899,-4.833837,7.99426],[-21.442266,-3.805248,8.994261],[-3.556697,-.009949,7.99426],[-21.442266,-3.805248,8.994261],[-6.288249,-.016716,8.994261],[-22.05899,-4.833837,7.99426],[-22.05957,4.719353,7.99426],[-21.442791,3.697532,8.994261],[-22.05899,-4.833837,7.99426],[-21.442791,3.697532,8.994261],[-21.442266,-3.805248,8.994261],[-23.213243,-5.430953,7.197281],[-23.213243,-5.430953,-7.148333],[-24.213274,-4.583536,-6.431051],[-23.213243,-5.430953,7.197281],[-24.213274,-4.583536,-6.431051],[-24.213274,-4.583536,6.48],[-23.213209,-6.3432,-7.945311],[-23.21389,6.218787,-7.945311],[-23.213858,5.30654,-7.148333],[-23.213209,-6.3432,-7.945311],[-23.213858,5.30654,-7.148333],[-23.213243,-5.430953,-7.148333],[-23.21389,6.218787,-7.945311],[-23.21389,6.218787,7.99426],[-23.213858,5.30654,7.197281],[-23.213858,5.30654,-7.148333],[-23.21389,6.218787,7.99426],[-23.213209,-6.3432,7.99426],[-23.213243,-5.430953,7.197281],[-23.21389,6.218787,7.99426],[-23.213243,-5.430953,7.197281],[-23.213858,5.30654,7.197281],[-24.213274,-4.583536,-6.431051],[-24.213827,4.459008,-6.431051],[-24.213827,4.459008,6.48],[-24.213274,-4.583536,6.48],[-23.213858,5.30654,7.197281],[-23.213243,-5.430953,7.197281],[-24.213274,-4.583536,6.48],[-23.213858,5.30654,7.197281],[-24.213274,-4.583536,6.48],[-24.213827,4.459008,6.48],[-23.213858,5.30654,-7.148333],[-23.213858,5.30654,7.197281],[-24.213827,4.459008,6.48],[-24.213827,4.459008,-6.431051],[-23.213243,-5.430953,-7.148333],[-23.213858,5.30654,-7.148333],[-24.213827,4.459008,-6.431051],[-23.213243,-5.430953,-7.148333],[-24.213827,4.459008,-6.431051],[-24.213274,-4.583536,-6.431051]],faces:[[0,1,2],[3,4,5],[3,5,6],[7,8,9],[7,9,10],[11,12,13],[11,13,14],[15,16,17],[15,17,18],[19,20,21],[22,23,24],[4,25,26],[4,26,5],[25,3,6],[25,6,26],[27,28,29],[30,31,32],[33,34,35],[36,37,38],[39,40,41],[42,43,44],[45,46,47],[48,49,50],[51,52,53],[54,55,56],[54,56,57],[58,59,60],[61,62,63],[64,65,66],[64,66,67],[68,69,70],[71,72,73],[74,75,76],[74,76,77],[78,79,80],[81,82,83]]},RED=16711680,GREEN=65280,BLUE=255,YELLOW=16776960,ORANGE=16747520,WHITE=16777215,colors=[16711680,65280,255,16776960,16747520,16777215],makeTriangle=function(d,a,b,c){var e=new THREE.Geometry,f=new THREE.MeshStandardMaterial({color:c,side:THREE.DoubleSide,roughness:.6}),g=_construct(THREE.Vector3,_toConsumableArray(d)),h=_construct(THREE.Vector3,_toConsumableArray(a)),i=_construct(THREE.Vector3,_toConsumableArray(b)),j=new THREE.Triangle(g,h,i),k=j.normal();e.vertices.push(j.a),e.vertices.push(j.b),e.vertices.push(j.c),e.faces.push(new THREE.Face3(0,1,2,k));var l=new THREE.Mesh(e,f);return l},makeCornerPiece=function(a,b,c){var d=new THREE.Object3D,e={14:a,15:a,16:a,17:a,10:a,26:b,30:b,31:b,32:b,33:b,34:c,18:c,22:c,23:c,24:c,25:c};return cubeCorner.faces.forEach(function(a,b){var c=e[Math.floor(b/2)]||0,f=makeTriangle(cubeCorner.vertices[a[0]],cubeCorner.vertices[a[1]],cubeCorner.vertices[a[2]],c);d.add(f)}),d},makeMiddlePiece=function(a,b,c){var d=new THREE.Object3D,e={14:c,18:c,19:c,20:c,21:c,22:b,26:b,27:b,28:b,29:b,30:a,34:a,35:a,36:a,37:a};return cubeMiddle.faces.forEach(function(a,b){var c=e[Math.floor(b/2)]||0,f=makeTriangle(cubeMiddle.vertices[a[0]],cubeMiddle.vertices[a[1]],cubeMiddle.vertices[a[2]],c);d.add(f)}),d},makeEdgePiece=function(a,b){var c=new THREE.Object3D,d={5:b,4:b,7:b,8:b,9:b,10:a,14:a,16:a,17:a,15:a};return cubeEdge.faces.forEach(function(a,b){var e=d[Math.floor(b/2)]||0;(14===b||8===b||11===b)&&(e=0);var f=makeTriangle(cubeEdge.vertices[a[0]],cubeEdge.vertices[a[1]],cubeEdge.vertices[a[2]],e);c.add(f)}),c},Cube=function(){function a(){var b=this;_classCallCheck(this,a),this.constructCube=function(){b.pieceC1=makeCornerPiece(WHITE,ORANGE,BLUE),b.pieceC2=makeCornerPiece(WHITE,BLUE,RED),b.pieceC3=makeCornerPiece(WHITE,RED,YELLOW),b.pieceC4=makeCornerPiece(WHITE,YELLOW,ORANGE),b.pieceC5=makeCornerPiece(GREEN,RED,BLUE),b.pieceC6=makeCornerPiece(GREEN,BLUE,ORANGE),b.pieceC7=makeCornerPiece(GREEN,ORANGE,YELLOW),b.pieceC8=makeCornerPiece(GREEN,YELLOW,RED),b.pieceM1=makeMiddlePiece(YELLOW,RED,ORANGE),b.pieceM2=makeMiddlePiece(BLUE,ORANGE,RED),b.pieceE1=makeEdgePiece(YELLOW,WHITE),b.pieceE2=makeEdgePiece(ORANGE,WHITE),b.pieceE3=makeEdgePiece(BLUE,WHITE),b.pieceE4=makeEdgePiece(RED,WHITE),b.pieceE5=makeEdgePiece(YELLOW,GREEN),b.pieceE6=makeEdgePiece(RED,GREEN),b.pieceE7=makeEdgePiece(BLUE,GREEN),b.pieceE8=makeEdgePiece(ORANGE,GREEN);var a,c,d,e,f,g=.5,h=16.5;a=new THREE.Matrix4().makeTranslation(g,-g,h),b.makeTransformToAllChildren(b.pieceC1,a),a=new THREE.Matrix4().makeTranslation(g,g,h),c=new THREE.Matrix4().makeRotationZ(degree(90)),f=a.multiply(c),b.makeTransformToAllChildren(b.pieceC2,f),a=new THREE.Matrix4().makeTranslation(-g,g,h),c=new THREE.Matrix4().makeRotationZ(degree(180)),f=a.multiply(c),b.makeTransformToAllChildren(b.pieceC3,f),a=new THREE.Matrix4().makeTranslation(-g,-g,h),c=new THREE.Matrix4().makeRotationZ(degree(270)),f=a.multiply(c),b.makeTransformToAllChildren(b.pieceC4,f),a=new THREE.Matrix4().makeTranslation(g,g,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),f=a.multiply(c),b.makeTransformToAllChildren(b.pieceC5,f),a=new THREE.Matrix4().makeTranslation(g,-g,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),d=new THREE.Matrix4().makeRotationZ(degree(90)),f=a.multiply(c).multiply(d),b.makeTransformToAllChildren(b.pieceC6,f),a=new THREE.Matrix4().makeTranslation(-g,-g,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),d=new THREE.Matrix4().makeRotationZ(degree(180)),f=a.multiply(c).multiply(d),b.makeTransformToAllChildren(b.pieceC7,f),a=new THREE.Matrix4().makeTranslation(-g,g,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),d=new THREE.Matrix4().makeRotationZ(degree(270)),f=a.multiply(c).multiply(d),b.makeTransformToAllChildren(b.pieceC8,f);var i=(h-3/4*g)/h,j=(h+3/4*g)/h,k=(h+g/4)/h;e=new THREE.Matrix4().makeScale(k,j,1),a=new THREE.Matrix4().makeTranslation(-g/2,0,0),f=a.multiply(e),b.makeTransformToAllChildren(b.pieceM1,f),c=new THREE.Matrix4().makeRotationZ(degree(180)),e=new THREE.Matrix4().makeScale(k,j,1),a=new THREE.Matrix4().makeTranslation(g/2,0,0),f=a.multiply(c).multiply(e),b.makeTransformToAllChildren(b.pieceM2,f),a=new THREE.Matrix4().makeTranslation(-1,0,h),e=new THREE.Matrix4().makeScale(i,i,1),f=a.multiply(e),b.makeTransformToAllChildren(b.pieceE1,f),a=new THREE.Matrix4().makeTranslation(0,-1,h),c=new THREE.Matrix4().makeRotationZ(degree(90)),f=a.multiply(c).multiply(e),b.makeTransformToAllChildren(b.pieceE2,f),a=new THREE.Matrix4().makeTranslation(1,0,h),c=new THREE.Matrix4().makeRotationZ(degree(180)),f=a.multiply(c).multiply(e),b.makeTransformToAllChildren(b.pieceE3,f),a=new THREE.Matrix4().makeTranslation(0,1,h),c=new THREE.Matrix4().makeRotationZ(degree(270)),f=a.multiply(c).multiply(e),b.makeTransformToAllChildren(b.pieceE4,f),a=new THREE.Matrix4().makeTranslation(-1,0,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),f=a.multiply(c).multiply(e),b.makeTransformToAllChildren(b.pieceE5,f),a=new THREE.Matrix4().makeTranslation(0,1,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),d=new THREE.Matrix4().makeRotationZ(degree(90)),f=a.multiply(c).multiply(d).multiply(e),b.makeTransformToAllChildren(b.pieceE6,f),a=new THREE.Matrix4().makeTranslation(1,0,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),d=new THREE.Matrix4().makeRotationZ(degree(180)),f=a.multiply(c).multiply(d).multiply(e),b.makeTransformToAllChildren(b.pieceE7,f),a=new THREE.Matrix4().makeTranslation(0,-1,-h),c=new THREE.Matrix4().makeRotationX(degree(180)),d=new THREE.Matrix4().makeRotationZ(degree(270)),f=a.multiply(c).multiply(d).multiply(e),b.makeTransformToAllChildren(b.pieceE8,f),scene.add(b.pieceC1),scene.add(b.pieceC2),scene.add(b.pieceC3),scene.add(b.pieceC4),scene.add(b.pieceC5),scene.add(b.pieceC6),scene.add(b.pieceC7),scene.add(b.pieceC8),scene.add(b.pieceM1),scene.add(b.pieceM2),scene.add(b.pieceE1),scene.add(b.pieceE2),scene.add(b.pieceE3),scene.add(b.pieceE4),scene.add(b.pieceE5),scene.add(b.pieceE6),scene.add(b.pieceE7),scene.add(b.pieceE8);var l=new THREE.PlaneGeometry(30,30);l.verticesNeedUpdate=!0;var m=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide});b.planeH1=new THREE.Mesh(l,m),b.planeH2=new THREE.Mesh(l,m),b.planeV=new THREE.Mesh(l,m),b.planeH1.position.set(0,0,8),b.planeH2.position.set(0,0,-8),b.planeH1.visible=!1,b.planeH2.visible=!1,b.planeV.visible=!1,c=new THREE.Matrix4().makeRotationY(degree(90)),d=new THREE.Matrix4().makeRotationZ(degree(-15)),f=d.multiply(c),b.planeV.applyMatrix(f),scene.add(b.planeH1),scene.add(b.planeH2),scene.add(b.planeV)},this.destructCube=function(){b.getAllPieces().forEach(function(a){return scene.remove(a)})},this.makeTransformToAllChildren=function(a,b){a.children.forEach(function(a){a.geometry.applyMatrix(b),a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1),a.updateMatrix()})},this.getAllPieces=function(){return scene.children.filter(function(a){return"Object3D"===a.type})},this.getCenterPointOfPiece=function(a){var b=new THREE.Box3().setFromObject(a),c=b.getBoundingSphere();return c.center},this.getCenterPointOfPlane=function(a){var b=a.geometry;b.computeBoundingBox();var c=b.boundingBox.getCenter();return a.localToWorld(c),c},this.checkCollisionOfVerticalPlane=function(){b.planeV.updateMatrixWorld();var a=b.planeV.geometry.vertices[0].clone();a.applyMatrix4(b.planeV.matrixWorld);var c=b.planeV.geometry.vertices[2].clone();c.applyMatrix4(b.planeV.matrixWorld);var d=[a,c].some(function(a){var c=new THREE.Raycaster(a,new THREE.Vector3(0,0,-1).normalize()),d=c.intersectObjects(b.getAllPieces(),!0);return d.some(function(a){return a.object.parent})});return d},this.getNormalOfVerticalPlane=function(){cube.planeV.updateMatrixWorld();var a=cube.planeV.geometry.faces[0].normal.clone();return a.applyMatrix4(cube.planeV.matrixWorld),a.normalize()},this.getAllPiecesBehindThePlane=function(a){var c=b.getNormalOfVerticalPlane(),d=b.getCenterPointOfPlane(b.planeV),e=b.getAllPieces().filter(function(e){var f=b.getCenterPointOfPiece(e),g=c.dot(f.sub(d));if(a){if(0<g)return!0;}else if(0>g)return!0});return e},this.rotateMiddle=function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],c=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(b.undoState=[b.rotateMiddle,[!a]],!b.animating){b.planeV.applyMatrix(new THREE.Matrix4().makeRotationZ(degree(a?-30:30)));var d=0;if(b.animating=!0,c)b.makeTransformToAllChildren(b.pieceM1,a?b.rotateZ30AntiNoAnimation:b.rotateZ30NoAnimation),b.makeTransformToAllChildren(b.pieceM2,a?b.rotateZ30AntiNoAnimation:b.rotateZ30NoAnimation),b.animating=!1;else var e=setInterval(function(){b.makeTransformToAllChildren(b.pieceM1,a?b.rotateZ30Anti:b.rotateZ30),b.makeTransformToAllChildren(b.pieceM2,a?b.rotateZ30Anti:b.rotateZ30),d++,3<=d&&(clearInterval(e),b.animating=!1)},isMobile?0:100)}},this.rotateTop=function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],c=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(b.undoState=[b.rotateTop,[!a]],!b.animating){var d=b.getCenterPointOfPlane(b.planeH1),e=d.z,f=0;if(b.animating=!0,c)b.getAllPieces().forEach(function(c){var d=b.getCenterPointOfPiece(c),f=d.z;e<f&&(b.makeTransformToAllChildren(c,a?b.rotateZ30AntiNoAnimation:b.rotateZ30NoAnimation),b.animating=!1)});else var g=setInterval(function(){b.getAllPieces().forEach(function(c){var d=b.getCenterPointOfPiece(c),f=d.z;e<f&&b.makeTransformToAllChildren(c,a?b.rotateZ30Anti:b.rotateZ30)}),f++,3<=f&&(clearInterval(g),b.animating=!1)},isMobile?0:100)}},this.rotateBottom=function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],c=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(b.undoState=[b.rotateBottom,[!a]],!b.animating){var d=b.getCenterPointOfPlane(b.planeH2),e=d.z,f=b.getAllPieces(),g=0;if(b.animating=!0,c)f.forEach(function(c){var d=b.getCenterPointOfPiece(c),f=d.z;e>f&&(b.makeTransformToAllChildren(c,a?b.rotateZ30AntiNoAnimation:b.rotateZ30NoAnimation),b.animating=!1)});else var h=setInterval(function(){f.forEach(function(c){var d=b.getCenterPointOfPiece(c),f=d.z;e>f&&b.makeTransformToAllChildren(c,a?b.rotateZ30Anti:b.rotateZ30)}),g++,3<=g&&(clearInterval(h),b.animating=!1)},isMobile?0:100)}},this.applyTransformations=function(){b.getAllPieces().forEach(function(a){a.children.forEach(function(a){a.updateMatrix(),a.geometry.applyMatrix(a.matrix),a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1),a.updateMatrix()})})},this.rotateVertical=function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],c=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],d=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];if(b.undoState=[b.rotateVertical,[!a,c]],!(b.checkCollisionOfVerticalPlane()||b.animating)){b.applyTransformations();var e=b.getAllPiecesBehindThePlane(c),f=b.getNormalOfVerticalPlane(),g=b.getCenterPointOfPlane(b.planeV),h=180,i=0;if(b.animating=!0,d)e.forEach(function(c){b.rotateAboutPoint(c,g,f.normalize(),(a?-1:1)*degree(h),!0),b.animating=!1});else var j=setInterval(function(){i++,e.forEach(function(c){b.rotateAboutPoint(c,g,f.normalize(),(a?-1:1)*degree(h/10),!0)}),10<=i&&(clearInterval(j),b.animating=!1)},isMobile?0:50)}},this.undo=function(){if(b.undoState.length){var a;(a=b.undoState)[0].apply(a,_toConsumableArray(b.undoState[1])),b.undoState=[]}},this.rotateZ30=new THREE.Matrix4().makeRotationZ(degree(10)),this.rotateZ30NoAnimation=new THREE.Matrix4().makeRotationZ(degree(30)),this.rotateZ30Anti=new THREE.Matrix4().makeRotationZ(degree(-10)),this.rotateZ30AntiNoAnimation=new THREE.Matrix4().makeRotationZ(degree(-30)),this.animating=!1,camera.position.z=120,this.constructCube(),this.undoState=[]}return _createClass(a,[{key:"rotateAboutPoint",value:function rotateAboutPoint(a,b,c,d,e){a.children.forEach(function(a){e=void 0!==e&&e,e&&a.parent.localToWorld(a.position),a.position.sub(b),a.position.applyAxisAngle(c,d),a.position.add(b),e&&a.parent.worldToLocal(a.position),a.rotateOnAxis(c,d)}),this.applyTransformations()}}]),a}(),cube=new Cube,verticalRotated=!1,simulate=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:isMobile?100:200,b=[cube.rotateBottom,cube.rotateMiddle,cube.rotateTop];timerSimulator=setInterval(function(){var c=cube.checkCollisionOfVerticalPlane(),d=Math.round(10*Math.random())%b.length;c||verticalRotated?(b[d](!0,!0),verticalRotated=!1):(cube.rotateVertical(!0,!0,!0),verticalRotated=!0),a-=1,0===a&&clearInterval(timerSimulator)})};